<section class="lancamentos">
	<h2>Novo lançamento</h2>
	<form (ngSubmit)="add()" #f="ngForm" class="form-grid">
		<mat-form-field appearance="outline">
			<mat-label>Data</mat-label>
			<input matInput type="date" name="date" [(ngModel)]="model.date" required />
		</mat-form-field>
		<mat-form-field appearance="outline">
			<mat-label>Descrição</mat-label>
			<input matInput type="text" name="description" [(ngModel)]="model.description" required />
		</mat-form-field>
		<mat-form-field appearance="outline">
			<mat-label>Valor</mat-label>
			<input matInput type="number" name="amount" [(ngModel)]="model.amount" step="0.01" required />
		</mat-form-field>
		<mat-form-field appearance="outline">
			<mat-label>Tipo</mat-label>
			<mat-select name="type" [(ngModel)]="model.type">
				<mat-option value="income">Receita</mat-option>
				<mat-option value="expense">Despesa</mat-option>
			</mat-select>
		</mat-form-field>
		<button mat-raised-button color="primary" type="submit" [disabled]="f.invalid">Adicionar</button>
	</form>

		<h3>Todos os lançamentos</h3>
		<div class="table-container">
			<table mat-table [dataSource]="dataSource" matSort>

				<ng-container matColumnDef="date">
					<th mat-header-cell *matHeaderCellDef mat-sort-header> Data </th>
					<td mat-cell *matCellDef="let t"> {{ t.date | date:'dd/MM/yyyy' }} </td>
				</ng-container>

				<ng-container matColumnDef="description">
					<th mat-header-cell *matHeaderCellDef mat-sort-header> Descrição </th>
					<td mat-cell *matCellDef="let t"> {{ t.description }} </td>
				</ng-container>

				<ng-container matColumnDef="type">
					<th mat-header-cell *matHeaderCellDef mat-sort-header> Tipo </th>
					<td mat-cell *matCellDef="let t"> {{ t.type === 'income' ? 'Receita' : 'Despesa' }} </td>
				</ng-container>

				<ng-container matColumnDef="amount">
					<th mat-header-cell *matHeaderCellDef mat-sort-header> Valor </th>
					<td mat-cell *matCellDef="let t" [class.expense]="t.type==='expense'"> {{ (t.type==='expense' ? -t.amount : t.amount) | currency:'BRL' }} </td>
				</ng-container>

				<ng-container matColumnDef="actions">
					<th mat-header-cell *matHeaderCellDef> Ações </th>
					<td mat-cell *matCellDef="let t">
						<button mat-icon-button color="warn" (click)="remove(t.id)" aria-label="Excluir">
							<mat-icon>delete</mat-icon>
						</button>
					</td>
				</ng-container>

				<tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
				<tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
			</table>

			<mat-paginator [pageSize]="10" [pageSizeOptions]="[5,10,20]" showFirstLastButtons></mat-paginator>
		</div>
</section>
